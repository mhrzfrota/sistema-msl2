sigepre.mslestrategia.com.br {
    tls matheusfilho9@hotmail.com
    encode zstd gzip

    @api {
        path /api/* /auth/* /health /db-check /docs /openapi.json
    }
    handle @api {
        reverse_proxy backend:8000 {
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-Host {host}
            transport http {
                dial_timeout 10s
                response_header_timeout 60s
            }
        }
    }

    handle {
        reverse_proxy frontend:80 {
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-Host {host}
        }
    }

    log {
        output stdout
        format console
    }
}

:80 {
    redir https://sigepre.mslestrategia.com.br{uri} 301
}
